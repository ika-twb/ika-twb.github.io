<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-09-20 Tue 18:46 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Using Offlineimap + MU4E to Setup A Powerful Email Client</title>
<meta name="author" content="Ilghar Kus" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
</style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Using Offlineimap + MU4E to Setup A Powerful Email Client</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org72692e4">1. Introduction</a></li>
<li><a href="#org911ac53">2. Setup guide: OfflineIMAP</a>
<ul>
<li><a href="#org02a13e6">2.1. Installation</a></li>
<li><a href="#org4368198">2.2. Configuration</a>
<ul>
<li><a href="#orgeee4a3c">2.2.1. [general]</a></li>
<li><a href="#org1786ce4">2.2.2. [mbnames]</a></li>
<li><a href="#orgdfca2ac">2.2.3. [Account example]</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<blockquote>
<p>
&lt;ika&gt; if i haven't fallen into the fucking rabbithole of emacs
</p>

<p>
&lt;ika&gt; who knows
</p>

<p>
&lt;ika&gt; maybe ill go use mutt
</p>
</blockquote>

<div id="outline-container-org72692e4" class="outline-2">
<h2 id="org72692e4"><span class="section-number-2">1.</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
<a href="https://github.com/OfflineIMAP/offlineimap3">OfflineIMAP</a> is an email syncing software that downloads your emails from the
remote ESP servers as an local directory, and will synchronize both sides
using IMAP protocol. You can use OfflineIMAP to setup multiple accounts with
their own local mail directory, remote host, refresh rate, filter, hooks, etc.
It's also extensible using Python, so you could automatically play your
favourite true crime podcast episode everytime you get a new email.
</p>

<p>
Mu4e is a mail client for emacs, shipped with Mu as a mail indexer and searcher
to deal with your various maildirs and mail files. It's fully documented,
asynchronous, support encryption, flow-optimized interface, and extensible,
using Elisp of course.
</p>

<p>
With OfflineIMAP as a backend synchronizer, and mu4e as a front-end interface
and searcher, you could have a consistent, customized and fast experience
dealing with emails, in your own and beloved text editor, and you won't ever
need to suffer 30mins of 5000rpm fan noize of compiling thunderbird to update
some feature you never use. (If you don't use Gentoo, at least we could agree
on the part that Thunderbird is totally bloatware.)
</p>
</div>
</div>

<div id="outline-container-org911ac53" class="outline-2">
<h2 id="org911ac53"><span class="section-number-2">2.</span> Setup guide: OfflineIMAP</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org02a13e6" class="outline-3">
<h3 id="org02a13e6"><span class="section-number-3">2.1.</span> Installation</h3>
<div class="outline-text-3" id="text-2-1">
<p>
If you have the offlineimap package in your distro repo and it's written in python3
(python2 version is obsolete and archived, don't use that, either the package or
the language), you could just download and install it using the package manager
that came with the distro.
</p>

<p>
If you're using Gentoo, however, the <code>offlineimap</code> package is not included in the
<code>gentoo</code> repo, so unless you wrote your own ebuild file or you find one in other
people's overlay, you have to download the code from the <a href="https://github.com/OfflineIMAP/offlineimap3">GitHub repo</a>.
</p>

<p>
Clone the repo using <code>git</code>:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ git clone https://github.com/OfflineIMAP/offlineimap3
</pre>
</div>

<p>
Then create a symbolic link of it to dir <code>~/.local/bin/</code>
</p>

<div class="org-src-container">
<pre class="src src-sh">$ ln -s /path/to/offlineimap3/offlineimap.py ${<span style="color: #00bcff;">HOME</span>}/.local/bin/offlineimap
</pre>
</div>

<p>
Then you're good to go.
</p>
</div>
</div>

<div id="outline-container-org4368198" class="outline-3">
<h3 id="org4368198"><span class="section-number-3">2.2.</span> Configuration</h3>
<div class="outline-text-3" id="text-2-2">
<p>
The configutaion file have a default path of <code>~/.offlineimaprc</code>, and in the cloned
repo you could find a <code>offlineimap.conf</code> file and a <code>offlineimap.conf.minimal</code> file.
</p>

<p>
The first file is a detailed documentation with all the options, explainations
and usage given, although the method of documentation in config files as comment
lines was always spurned by me, this file by it self is written as an exellent
document.
</p>
</div>

<div id="outline-container-orgeee4a3c" class="outline-4">
<h4 id="orgeee4a3c"><span class="section-number-4">2.2.1.</span> [general]</h4>
<div class="outline-text-4" id="text-2-2-1">
<p>
<code>general</code> segment is used to declare accounts, the python extension file, and
other options related to the overall program-running and syncing mechanism.
</p>

<p>
For the example below i'll use a test account <code>example@example.com</code>. And be aware
that I won't demonstrate any other options provided by the program than the ones
that my configuration file is using right now, so it is recommended to peruse
the example config file if you want to use other features.
</p>

<div class="org-src-container">
<pre class="src src-python">[general]
<span style="color: #00bcff;">accounts</span> = example
<span style="color: #00bcff;">pythonfile</span> = ~/.offlineimap_ext.py
<span style="color: #00bcff;">maxsyncaccounts</span> = 1
</pre>
</div>

<p>
<code>accounts</code> is the part that you declare all your accounts, seperated by comma.
The name you used here do not have to be your username at your ESP or your
email account. It's just needed for account settings later in the config file.
</p>

<p>
<code>pythonfile</code> is used to declare the python program you use to extend the program
capability. It's imported and interpreted during parsing the config file,
before running any core mechanism. You can basically use this to do anything
you want, in my case it's used for extracting passwords from gpg encrypted files.
</p>

<p>
<code>maxsyncaccounts</code> is used to specify the max amount of concurrent syncing, the
developers and I both recommend this amount to be one, whether you decide to run
multiple offlineimap instances for multiple accounts or using one instance for all
accounts. The reason is that later in the section of post-sync hook, we need to
call <code>mu</code> to index the mail directory for changes, and it cannot be ran concurrently
with multiple instances.
</p>

<p>
And in the next-next section you need to declare the account-specific settings.
</p>
</div>
</div>

<div id="outline-container-org1786ce4" class="outline-4">
<h4 id="org1786ce4"><span class="section-number-4">2.2.2.</span> [mbnames]</h4>
<div class="outline-text-4" id="text-2-2-2">
<p>
Mailbox name recording section, skipped cause I don't use it.
</p>
</div>
</div>

<div id="outline-container-orgdfca2ac" class="outline-4">
<h4 id="orgdfca2ac"><span class="section-number-4">2.2.3.</span> [Account example]</h4>
<div class="outline-text-4" id="text-2-2-3">
<p>
This part is for specifying, of course, account related settings.
</p>

<p>
First of all there's two repository that you need to specify,
a local one, and a remote one.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #00bcff;">localrepository</span> = LocalExample
<span style="color: #00bcff;">remoterepository</span> = RemoteExample
</pre>
</div>

<p>
The repo name in here doesn't need to match up with anything,
other than the name in the [Repository] section below.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #00bcff;">autorefresh</span> = 5
<span style="color: #00bcff;">quick</span> = 10
<span style="color: #00bcff;">postsynchook</span> = mu index
</pre>
</div>

<p>
Offlineimap could run indefinitely, as long as you don't kill it.
Such mechanism enables the feature of automatic syncing with the remote server,
specified in the <code>autorefresh</code> variable. The time here uses unit of minute, and
supports fractional values like 3.25.
</p>

<p>
If your system uses systemd, it's probably better to use the systemd timer
instead of this mechanism, for the sake of integrity and better system management.
</p>

<p>
Option <code>postsynchook</code> offers a feature to run a shell one-liner after the a sync.
Here the <code>mu</code> program is called to index the maildir.
</p>

<p>
You can also add a notification command here, such as <code>notify-send</code>,
to send a desktop popup, but given the condition that a mail sync
doesn't neccessarily mean new emails, you could save that for the later part.
</p>

<p>
Other Options such as <code>maxsize</code> for limited mailbox syncing, <code>maxage</code> for date-specified
mail syncing, etc. could be found in the doc.
</p>

<p>
<b>To be noticed</b>, if you're using Gmail there's a whole other category for gmail account
configuration, which is also documented in the <code>offlineimap.conf</code>.
</p>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Ilghar Kus</p>
<p class="date">Created: 2022-09-20 Tue 18:46</p>
</div>
</body>
</html>
