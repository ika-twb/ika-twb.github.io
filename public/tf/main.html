<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-05-14 Sat 13:25 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>浅谈RSA算法以及公钥密码学在日常生活中的应用</title>
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
</style>
<style type="text/css">
/* Base */html,body {    background-color: #222;    min-height: 100%;    line-height: 1.5;}body {    color: #fafafa;    font-family: "Courier New";}::selection {    background-color:  #2ecc40;    color: white;}/* Responsive content positioning */@media only screen and (min-width: 1020px) /* Large screens */{    body{        padding: 10vh 25vw;    }}@media only screen and (max-width: 1020px) and (min-width: 750px) /* Small screens */{    body{        padding: 5vh 10vw;    }}@media only screen and (max-width: 750px) /* Small screens */{    body{        padding: 2vh 5vw;    }}/* Headers */h1{font-size: 2.5rem;}h2{font-size: 1.7rem;}h1 > .subtitle, h3, h4, h5, h6{font-size: 1.3rem;}.title{    margin-bottom: 2.5rem;}/* Padding & Margin */* {margin: 0; padding: 0;}pre, blockquote, ul, ol, p, table{    margin: 1rem 0;}h1, h2{margin-top: 2rem; line-height: 2rem;}h3, h4, h5, h6{margin-top: 1rem;}/* Links  */a, a:visited {    color: #01ff70;    text-decoration: underline;}a:hover, a:focus, a:active {    color: #2ecc40;}/* Code */pre {    font-family: "Courier New";    padding: .5rem;    background-color: #333;    padding: 0.5rem;    border-radius: 0.2rem;    font-size: 0.9rem;    color: #EEE;    overflow-x: auto;}.org-keyword{    color: #01ff70;}.org-rainbow-delimiters-depth-1{    color: #2ecc40;}.org-rainbow-delimiters-depth-2{    color: #01ff70;}/* Blockquotes */blockquote {    border-left: 3px solid #01ff70;    padding-left: 1rem;}li{    list-style-position: inside;}/* Tags */.tag{    margin-top: 0.5rem;    display: block;    color: white;    font-size: var(--font-size-xsmall);}.tag > span{		font-weight: 400;    font-size: 0.8rem;    background-color: #444;    text-transform: uppercase;    border-radius: 2px;    width: fit-content;    height: auto;    padding: 1px 5px;}/* Keywords */.todo{    color: #2ecc40;}.done{    color: #444;}/* Overflows */.outline-text-2, .outline-text-3, .outline-text-4{	  max-width: 100%;	  overflow-x: auto;}/* Table */tr:nth-child(even) {    background-color: #333;}th, td{    padding: 0.5rem;    text-align: center;}.underline{    text-decoration: underline;}img{    max-width: 100%;    height: auto;}
</style>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">浅谈RSA算法以及公钥密码学在日常生活中的应用</h1>
<div id="outline-container-orge8ba15a" class="outline-2">
<h2 id="orge8ba15a"><span class="section-number-2">1.</span> RSA算法的背景</h2>
<div class="outline-text-2" id="text-1">
<p>
1974:
</p>

<p>
本科生 Ralph C. Merkle 在向自己CS244课程的教师 Lance Hoffman提交的一份提案作业当中
</p>

<p>
提出了关于在两个节点之间通过不安全的通讯线路进行安全通讯的方案。
</p>


<div id="org8e2b163" class="figure">
<p><img src="merkle.png" alt="merkle.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgd3b07f7" class="outline-2">
<h2 id="orgd3b07f7"><span class="section-number-2">2.</span> RSA算法的背景</h2>
<div class="outline-text-2" id="text-2">
<p>
这份方案当初并没有获得Hoffman的青睐，而且他还在Merkle的作业上写道：
</p>
<blockquote>
<p>
Project 2 looks more reasonable maybe because your description, Project 1 is muddled terribly. Talk to me about this today.
</p>
</blockquote>

<div id="orgb11e857" class="figure">
<p><img src="merkle.png" alt="merkle.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org5b42f51" class="outline-2">
<h2 id="org5b42f51"><span class="section-number-2">3.</span> RSA算法的背景</h2>
<div class="outline-text-2" id="text-3">
<p>
1975年，斯坦福大学的教授 Martin E. Hellman 与同事 Whitfield Diffle 共同开始研究加密机制。
</p>

<p>
1976年共同发表著名论文 <i>New Directions in Cryptogrphy</i>
</p>

<p>
发明了 Diffle-Hellman 密钥交换协议
</p>

<p>
两人共同获得了2015年的图灵奖
</p>


<div id="org0f74e9b" class="figure">
<p><img src="diffie_hellman_turing_award.jpg" alt="diffie_hellman_turing_award.jpg" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgc254971" class="outline-2">
<h2 id="orgc254971"><span class="section-number-2">4.</span> RSA算法的背景</h2>
<div class="outline-text-2" id="text-4">
<p>
1977年，麻省理工学院的Ron Rivest, Adi Shamir, Leonard Adleman发表了RSA算法
</p>

<p>
提供了另外一种实现方法
</p>


<div id="orga61eb02" class="figure">
<p><img src="rsa.jpg" alt="rsa.jpg" />
</p>
</div>
</div>
</div>

<div id="outline-container-org9db3bb7" class="outline-2">
<h2 id="org9db3bb7"><span class="section-number-2">5.</span> RSA算法的背景</h2>
<div class="outline-text-2" id="text-5">
<p>
使用大于40位二进制密钥的加密系统在美国被认为是军需品，受到联邦政府的管制
</p>

<p>
软件上也没有成熟可用的实现
</p>

<p>
故此时还没有广泛使用
</p>
</div>
</div>

<div id="outline-container-orgcc36cdc" class="outline-2">
<h2 id="orgcc36cdc"><span class="section-number-2">6.</span> RSA算法的背景</h2>
<div class="outline-text-2" id="text-6">
<p>
1991年，Phil Zimmermann开发了第一版PGP程序并开始在网络上分发
</p>


<div id="orgfd514fb" class="figure">
<p><img src="pzimmerman.png" alt="pzimmerman.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org910c1b8" class="outline-2">
<h2 id="org910c1b8"><span class="section-number-2">7.</span> RSA算法的背景</h2>
<div class="outline-text-2" id="text-7">
<p>
在受到美国政府的的调查后，Zimmermann将源代码出版成一本书，旨在受到美国宪法第一修正案（出版自由）的保护。
</p>

<p>
OCR技术/输入将源代码编码进电脑
</p>

<p>
使用自由分发的Gnu C编译器（GCC）将源代码编译成可执行的二进制文件。
</p>


<div id="orgac5e27f" class="figure">
<p><img src="pgp_book.jpg" alt="pgp_book.jpg" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgb6948dd" class="outline-2">
<h2 id="orgb6948dd"><span class="section-number-2">8.</span> RSA算法的背景</h2>
<div class="outline-text-2" id="text-8">
<p>
1997年，Zimmermann将PGP制定成一个公开的互联网标准，称之为OpenPGP1
</p>

<p>
Werner Koch 为GNU项目编写了兼容OpenPGP协议的GnuPG, 使用GPL。
</p>

<p>
公开密钥加密以及RSA算法终于有了易用的软件实现
</p>
</div>
</div>

<div id="outline-container-org87e9862" class="outline-2">
<h2 id="org87e9862"><span class="section-number-2">9.</span> 李四与小丽的故事</h2>
<div class="outline-text-2" id="text-9">
<p>
在介绍RSA等公开密钥加密（又称非对称加密）之前
</p>

<p>
密码学的背景知识，尤其是对称密钥加密，以及其与非对称加密之间的区别
</p>
</div>
</div>
<div id="outline-container-org6045dab" class="outline-2">
<h2 id="org6045dab"><span class="section-number-2">10.</span> 李四与小丽的故事</h2>
<div class="outline-text-2" id="text-10">
<p>
李四 \(\leftrightarrow\) 小丽
</p>

<p>
\newline
</p>

<p>
李四 \(\leftrightarrow\) 张三 \(\leftrightarrow\) 小丽
</p>
</div>
</div>

<div id="outline-container-org82e90bb" class="outline-2">
<h2 id="org82e90bb"><span class="section-number-2">11.</span> 李四与小丽的故事</h2>
<div class="outline-text-2" id="text-11">
<p>
"Hello,World!"  \(\rightarrow\) "60fde&#x2026;&#x2026;ba289" \(\rightarrow\) "Hello,World!"
</p>
</div>
</div>

<div id="outline-container-org62bc19a" class="outline-2">
<h2 id="org62bc19a"><span class="section-number-2">12.</span> 李四与小丽的故事</h2>
<div class="outline-text-2" id="text-12">

<div id="orgab335e6" class="figure">
<p><img src="rot13.png" alt="rot13.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org742c3fe" class="outline-2">
<h2 id="org742c3fe"><span class="section-number-2">13.</span> 李四与小丽的故事</h2>
<div class="outline-text-2" id="text-13">

<div id="orga1c341b" class="figure">
<p><img src="exford.jpg" alt="exford.jpg" />
</p>
</div>

<p>
(单词所在页码 ＋ 字母序数[A：0, Z：25]) mod 26 \(\rightarrow\) 字母
</p>
</div>
</div>

<div id="outline-container-orge30e982" class="outline-2">
<h2 id="orge30e982"><span class="section-number-2">14.</span> 李四与小丽的故事</h2>
<div class="outline-text-2" id="text-14">
<p>
\[
Pt &= A(26-Nd(W) \mod 26 + N(Ct)
\]
\[
Ct &= A((Nd(W) + N(Pt)) \mod 26
\]
</p>
</div>
</div>

<div id="outline-container-org3ad60ce" class="outline-2">
<h2 id="org3ad60ce"><span class="section-number-2">15.</span> 李四与小丽的故事</h2>
<div class="outline-text-2" id="text-15">
<p>
明文 \(\rightarrow^{f(x)}\) 密文 \(\rightarrow^{f^{-1}(x)}\) 明文
</p>
</div>
</div>

<div id="outline-container-org7a96ec9" class="outline-2">
<h2 id="org7a96ec9"><span class="section-number-2">16.</span> 李四与小丽的故事</h2>
<div class="outline-text-2" id="text-16">
<p>
\[
69 \cdot 71 = 4899
\]
\[
999908083871821 = ? \quad \cdot \quad ?
\]
</p>
</div>
</div>

<div id="outline-container-org342f7f5" class="outline-2">
<h2 id="org342f7f5"><span class="section-number-2">17.</span> 对称密钥加密</h2>
<div class="outline-text-2" id="text-17">
<p>
维吉尼亚密码 \(\rightarrow\) 一次性密码本
</p>


<div id="org3d8404e" class="figure">
<p><img src="otp.png" alt="otp.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org2777058" class="outline-2">
<h2 id="org2777058"><span class="section-number-2">18.</span> RSA的加密原理</h2>
</div>

<div id="outline-container-org03b66c6" class="outline-2">
<h2 id="org03b66c6"><span class="section-number-2">19.</span> RSA的加密原理</h2>
<div class="outline-text-2" id="text-19">
<ul class="org-ul">
<li>公钥: 就是加密方或接收方公开的密钥，默认公钥是会被窃听者获取到的。</li>
<li>私钥：需要双方自己严格保护不能泄漏给其他人。</li>
<li>目的：便是通过不安全的通讯线路建立安全的通讯连接。</li>
</ul>
</div>
</div>
<div id="outline-container-org3aacb61" class="outline-2">
<h2 id="org3aacb61"><span class="section-number-2">20.</span> RSA的加密原理</h2>
<div class="outline-text-2" id="text-20">
<p>
Deffie-Hellman协议的通信双方需要根据
</p>

<p>
彼此的公钥和自己的私钥计算出一个共同的加密密钥
</p>

<p>
密钥是不经过通讯线路
</p>

<p>
双方各自计算出来后直接开始加解密
</p>
</div>
</div>
<div id="outline-container-org121f473" class="outline-2">
<h2 id="org121f473"><span class="section-number-2">21.</span> RSA的加密原理</h2>
<div class="outline-text-2" id="text-21">
<p>
假设发送方(\(S\))和接收方(\(R\))的公钥(\(p\))和密钥(\(s\))分别为：\(S_p\),\(R_p\),\(S_s\),\(R_s\)
</p>

<p>
其中，两个密钥 \(S_s\) 和 \(R_s\) 是不公开的。
</p>

<p>
\(q\) 和 \(a\) ，其中 \(q\) 是一个质数， \(a\) 是 \(q\) 的一个原根。
</p>

<p>
\(S_s\) 和 \(R_s\) 分别是两个小于 \(q\) 的随机数，由 \(S\) ， \(R\) 两方私密保存。
</p>
</div>
</div>
<div id="outline-container-org90ed997" class="outline-2">
<h2 id="org90ed997"><span class="section-number-2">22.</span> RSA的加密原理</h2>
<div class="outline-text-2" id="text-22">
<p>
\(S_p\) 和 \(R_p\) 便使用双方各自的私钥和 \(a\) ， \(q\) 计算而成:
\[
S_p = a^{S_s} \mod q
\]
\[
R_p = a^{R_s} \mod q
\]
</p>

<p>
共享密钥 \(K\) 的计算方式如下：
\[
K_R = S_p^{R_s} \mod q
\]\[
K_S = R_p^{S_s} \mod q
\]
</p>
</div>
</div>

<div id="outline-container-org6201ec7" class="outline-2">
<h2 id="org6201ec7"><span class="section-number-2">23.</span> RSA的加密原理</h2>
<div class="outline-text-2" id="text-23">
<p>
我们很容易就可以证明 \(K_R = K_S\):
</p>
\begin{align}
K_R &= S_p^{R_s} \mod q \\
K_R &= (a^{S_s} \mod q)^{R_s} \mod q \\
K_R &= a^{S_s\cdot R_s} \mod q \\
K_R &= (a^{R_s} \mod q)^{S_s} \mod q \\
K_R &= R_p^{S_s} \mod q \\
K_R &= K_S
\end{align}
</div>
</div>
<div id="outline-container-org8b0fd78" class="outline-2">
<h2 id="org8b0fd78"><span class="section-number-2">24.</span> RSA的加密原理</h2>
<div class="outline-text-2" id="text-24">
<p>
第三方窃听者只掌握 \(S_p\) ， \(R_p\) ， \(a\) 与 \(q\) ，
</p>

<p>
只能通过算离散对数的方式去获得 \(S_s\) 和 \(R_s\) 。
</p>
</div>
</div>
<div id="outline-container-orgcc82338" class="outline-2">
<h2 id="orgcc82338"><span class="section-number-2">25.</span> RSA的加密原理</h2>
<div class="outline-text-2" id="text-25">
<p>
Deffie-Hellman协议需要通信双方都持有对方的公钥才可以实现加解密
</p>

<p>
如果接收方不清楚发送方的身份，便无法得到对方的公钥
</p>

<p>
无法进行解密操作
</p>
</div>
</div>

<div id="outline-container-org8efa029" class="outline-2">
<h2 id="org8efa029"><span class="section-number-2">26.</span> RSA的加密原理</h2>
<div class="outline-text-2" id="text-26">
<p>
RSA算法与Deffie-Hellman协议的不同之处:
</p>

<p>
RSA算法只需要用接收方的公钥便可以加密信息
</p>

<p>
接收方可以直接使用自己的私钥解密信息
</p>

<p>
在这里我们只需要分析接收方的密钥生成过程
</p>
</div>
</div>

<div id="outline-container-org7f41d5f" class="outline-2">
<h2 id="org7f41d5f"><span class="section-number-2">27.</span> RSA的加密原理</h2>
<div class="outline-text-2" id="text-27">
<p>
假设 \(p\) 与 \(q\) 是两个质数 ，然后他们的乘积为 \(n\) ，
</p>

<p>
计算 \(n\) 的欧拉函数：
\[
\varphi (n) = \varphi (p\cdot q)
\]
欧拉函数是积性函数，所以：
\[
\varphi (p\cdot q) = \varphi(p)\cdot \varphi(q) = (p-1)(q-1)
\]
所以：
\[
\varphi (n) = (p-1)(q-1)
\]
</p>
</div>
</div>
<div id="outline-container-orge846e5c" class="outline-2">
<h2 id="orge846e5c"><span class="section-number-2">28.</span> RSA的加密原理</h2>
<div class="outline-text-2" id="text-28">
<p>
再随机选择一个大于 1 小于 \(\varphi(n)\) 的整数 \(e\) , 并计算 \(e\) 对于的模反元素 \(d\) 。
</p>

<p>
模反元素是数论中的一个概念:
</p>

<p>
对于两个互质的整数 \(a\),\(n\) ，一定存在元素 \(b\) 使得:
</p>

<p>
\[
a\cdot b \equiv 1 (\mod n)
\]
</p>

<p>
<i>i.e.</i> a与b的乘积除以n的余数为1
</p>

<p>
此时就称b是a对于n的模反元素。
</p>
</div>
</div>
<div id="outline-container-orgd4b3c7c" class="outline-2">
<h2 id="orgd4b3c7c"><span class="section-number-2">29.</span> RSA的加密原理</h2>
<div class="outline-text-2" id="text-29">
<p>
将(n,e)封装成公钥，(n,d)封装成私钥
</p>

<p>
密钥生成完成
</p>
</div>
</div>

<div id="outline-container-org710ff2b" class="outline-2">
<h2 id="org710ff2b"><span class="section-number-2">30.</span> RSA的加密原理</h2>
<div class="outline-text-2" id="text-30">
<p>
\(S\) 想要给 \(R\) 发送一条信息
</p>

<p>
于是他找到 \(R\) 的公钥，提取出来里面的 \(n\) 和 \(e\)
</p>

<p>
将明文 \(Pt\) 进行如下操作获得密文 \(Ct\) ：
\[
Ct = (Pt)^{e} \mod n
\]
</p>

<p>
将密文 \(Ct\) 发送给 \(R\) ， \(R\) 再通过自己的私钥 \((n,d)\) 对密文 \(Ct\) 进行如下的操作获得明文 \(Pt\) ：
\[
Pt = (Ct)^d \mod n
\]
</p>
</div>
</div>

<div id="outline-container-org6b997a2" class="outline-2">
<h2 id="org6b997a2"><span class="section-number-2">31.</span> RSA的加密原理</h2>
<div class="outline-text-2" id="text-31">
<p>
合法性和安全性证明：
即，证明 \((Ct)^d \equiv Pt (\mod n)\)
</p>

<p>
已知： \(Ct = (Pt)^e \mod n\)
</p>

<p>
故即证： $Ct = (Pt)<sup>e</sup> - kn \quad (k &isin; \mathbb{Z} $
</p>

<p>
带入，得： \(((Pt)^e - kn)^d \equiv Pt (\mod n)\)
\(\quad (Pt)^{ed} - kn^{d} \equiv\)
</p>

<p>
即证： \((Pt)^{ed} \equiv Pt (\mod n)\)
</p>
</div>
</div>

<div id="outline-container-orgdd94545" class="outline-2">
<h2 id="orgdd94545"><span class="section-number-2">32.</span> RSA的加密原理</h2>
<div class="outline-text-2" id="text-32">
<p>
\(d\) 是 \(e\) 关于 \(\varphi(n)\) 的模反元素,故：
\[
ed \equiv 1 (\mod \varphi(n))
\]
即： \(ed = k\cdot \varphi(n) + 1\)
</p>

<p>
代入原式：
\[
(Pt)^{k\varphi(n) + 1} \equiv Pt (\mod n)
\]
</p>
</div>
</div>
<div id="outline-container-org2844402" class="outline-2">
<h2 id="org2844402"><span class="section-number-2">33.</span> RSA的加密原理</h2>
<div class="outline-text-2" id="text-33">
<p>
根据欧拉定理：
\[
(Pt)^{\varphi(n)} \equiv 1 (\mod n)
\]
故：
</p>

<p>
\[(Pt)^{k\varphi(n)} \equiv 1^n (\mod n)\]
\[(Pt)^{k\varphi(n)} \cdot Pt \equiv Pt (\mod n)\]
\[(Pt)^{k\varphi(n)+1} \equiv Pt (\mod n)\]
</p>

<p>
关于 \(Pt\) 和 \(n\) 不互质情况的证明这里从略。
</p>
</div>
</div>

<div id="outline-container-org729d3a5" class="outline-2">
<h2 id="org729d3a5"><span class="section-number-2">34.</span> RSA的加密原理</h2>
<div class="outline-text-2" id="text-34">
<p>
第三方监听者拥有的信息只有接收方的公钥 \((n,e)\)
</p>

<p>
如果他想要将 \(Ct\) 转换为 \(Pt\) ，便需要通过 \(n\) , \(e\) 计算出来 \(d\) .
</p>

<p>
$ed &equiv; 1 (\mod &varphi;(n)) , 要先算出来 \(\varphi(n)\), 然而：
\[
\varphi(n) = (p-1)(q-1)
\]
所以需要算出来 \(p\) 和 \(q\) 。
</p>
</div>
</div>

<div id="outline-container-org1cd251c" class="outline-2">
<h2 id="org1cd251c"><span class="section-number-2">35.</span> RSA的加密原理</h2>
<div class="outline-text-2" id="text-35">
<p>
这个运算便是将n分解为p与q乘积的运算
</p>

<p>
当p与q足够大时，我们就可以确保我们的隐私是被安全加密的
</p>

<p>
因为攻击者攻击加密算法的手段是不实际的 (<i>infeasible</i>).
</p>
</div>
</div>
<div id="outline-container-orgc81d868" class="outline-2">
<h2 id="orgc81d868"><span class="section-number-2">36.</span> RSA的加密原理</h2>
<div class="outline-text-2" id="text-36">
<p>
至今为止人类成功破解的最大的RSA密钥长度是768个二进制位，232个十进制位
</p>

<p>
也就是说一个232位的两个大质数的乘积被分解为原来的两个质数。
</p>

<blockquote>
<p>
12301866845301177551304949583849627207728535695953347921973224521517264005
07263657518745202199786469389956474942774063845925192557326303453731548268
50791702612214291346167042921431160222124047927473779408066535141959745985
6902143413
= 33478071698956898786044169848212690817704794983713768568912431388982883793
878002287614711652531743087737814467999489
× 36746043666799590428244633799627952632279158164343087642676032283815739666
511279233373417143396810270092798736308917
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org8055d05" class="outline-2">
<h2 id="org8055d05"><span class="section-number-2">37.</span> RSA的加密原理</h2>
<div class="outline-text-2" id="text-37">
<p>
现在的RSA密钥一般都是以1024位起步，在重要的场合使用2048位或4096位。
</p>

<p>
随着科技的发展，计算机的算力逐渐提高，人们的隐私保护意识增强，
</p>

<p>
在计算机的算力允许的条件下这个数字当然是越大越好。
</p>

<p>
而且大部分的RSA实现方法都是先使用 <code>AES</code> 等对称加密算法加密正文
</p>

<p>
然后使用 RSA 加密密钥，再将两者封装起来， 以节约计算成本。
</p>
</div>
</div>
<div id="outline-container-orge913be4" class="outline-2">
<h2 id="orge913be4"><span class="section-number-2">38.</span> RSA的加密原理</h2>
<div class="outline-text-2" id="text-38">
<p>
也有在程序开发人员的疏忽下导致RSA算法的加密失效的例子
</p>

<p>
2006年，著名的GNU/Linux发行版Debian的开发人员在使用代码自动审计工具时，错误地注释了一行代码，
</p>

<p>
恰巧这行代码就是用来确保SSH协议生成密钥时的熵足够大的。
</p>

<p>
这个错误的下场是生成的SSH密钥的熵降到了15个比特，也就是说总共只有32767个密钥会被生成。
</p>


<div id="orgfbd0eff" class="figure">
<p><img src="openssl_rsa_vulnerability.png" alt="openssl_rsa_vulnerability.png" />
</p>
</div>
</div>
</div>
<div id="outline-container-org6decc28" class="outline-2">
<h2 id="org6decc28"><span class="section-number-2">39.</span> RSA的加密原理</h2>
<div class="outline-text-2" id="text-39">
<p>
在这个漏洞被曝光后，有人在两个小时内就生成了所有的1024位密钥和2048位密钥并公布到网络上，
</p>

<p>
导致黑帽黑客利用这个漏洞大范围扫描并尝试用生成的私钥暴力侵入具有此漏洞的Debian服务器。
</p>


<div id="orge2e056d" class="figure">
<p><img src="rsa_keys_generated.png" alt="rsa_keys_generated.png" />
</p>
</div>
</div>
</div>
<div id="outline-container-org11d19ef" class="outline-2">
<h2 id="org11d19ef"><span class="section-number-2">40.</span> 非对称密钥的应用</h2>
<div class="outline-text-2" id="text-40">
<p>
非对称密钥在我们的日常生活中的使用情形十分的广泛。
</p>

<p>
从代替Telnet协议的SSH(Secure SHell)协议，到HTTPS协议。
</p>

<p>
为了避免监听者发动中间人攻击，通信的所有流量都会先加密然后通过数据传输线路，
</p>

<p>
实现通过不安全的通信线路进行安全通信的功能。
</p>
</div>
</div>
<div id="outline-container-org8b200f0" class="outline-2">
<h2 id="org8b200f0"><span class="section-number-2">41.</span> 非对称密钥的应用</h2>
<div class="outline-text-2" id="text-41">
<p>
非对称密钥加密也运用在电子邮件当中，为了防止机密或隐私信息被窃取，
</p>

<p>
通常会将电子邮件使用PGP或者GPG(GnuPG)加密，
</p>

<p>
将加密后的文本发送到对方，对方再使用自己的私钥进行解密查看。
</p>
</div>
</div>
<div id="outline-container-org73a2c16" class="outline-2">
<h2 id="org73a2c16"><span class="section-number-2">42.</span> 参考文献</h2>
<div class="outline-text-2" id="text-42">
<p>
[1] Diffie, W.; Hellman, M., New Directions in Cryptography, IEEE Transactions on Information Theory;22(6);644-654.
</p>

<p>
[2] Diffie, W.,The First Ten Years of Public-key Cryptography, Proceedings of the IEEE;76(5);560-577.
</p>

<p>
[3] Peter Kim, The Hacker Playbook 2: Practical Guide to Penetration Testing, Secure Planet LLC, 2015.
</p>

<p>
[4] Hadnagy, C.; Ekman,P., Unmasking the Social Engineer: The Human Element of Security, John Wiley &amp; Sons, Inc., 2014.
</p>

<p>
[5] TJ O’Connor, Violent Python: A Cookbook for Hackers, Forensic Analysrs, Penetration Testers and Security Engineers, Syngress, 2012.
</p>

<p>
[6] 闵嗣鹤、严士健. 初等数论(第四版). 高等教育出版社. 2020.
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2022-05-14 Sat 13:25</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
